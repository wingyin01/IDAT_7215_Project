{% extends "base.html" %}

{% block title %}Home - IDAT7215 Hong Kong Legal Expert System{% endblock %}

{% block content %}
<div class="card">
    <h2>Welcome to the IDAT7215 Hong Kong Legal Expert System</h2>
    <p style="margin-bottom: 1.5rem;">
        <strong>IDAT7215 Group Project:</strong> A comprehensive expert system covering <strong>ALL Hong Kong law</strong> - criminal, civil, commercial, employment, property, family law, and more.
        This system uses official e-Legislation XML data downloaded from <a href="https://data.gov.hk/en-data/dataset/hk-doj-hkel-legislation-current" target="_blank" style="color: #667eea;">Hong Kong Government Open Data Portal</a>, combined with rule-based reasoning and machine learning for legal analysis.
    </p>
    
    <div class="alert alert-success">
        <strong>üìö Comprehensive Knowledge Base:</strong> Loaded with <strong id="total-sections">52,269</strong> sections 
        from <strong id="total-ordinances">2,234</strong> Hong Kong ordinances across <strong id="total-categories">11</strong> legal categories.
    </div>
</div>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
    <div class="card" style="border-top: 4px solid #667eea;">
        <h2>‚öñÔ∏è Legal Consultation</h2>
        <p>Describe case facts from any legal area to get rule-based analysis. The system identifies potential legal issues using forward chaining inference across all Hong Kong law.</p>
        <a href="/consultation" class="btn btn-primary" style="margin-top: 1rem; display: inline-block; text-decoration: none;">Start Consultation ‚Üí</a>
    </div>
    
    <div class="card" style="border-top: 4px solid #764ba2;">
        <h2>üîç Case Search</h2>
        <p>Find similar past cases from Hong Kong courts using TF-IDF vectorization and cosine similarity matching across criminal, civil, and commercial matters.</p>
        <a href="/case-search" class="btn btn-primary" style="margin-top: 1rem; display: inline-block; text-decoration: none;">Search Cases ‚Üí</a>
    </div>
    
    <div class="card" style="border-top: 4px solid #f093fb;">
        <h2>üìÑ Document Analysis</h2>
        <p>Paste any legal document to automatically extract facts using NLP, identify legal issues, and get instant analysis with relevant ordinance references.</p>
        <a href="/document-analysis" class="btn btn-primary" style="margin-top: 1rem; display: inline-block; text-decoration: none;">Analyze Document ‚Üí</a>
    </div>
</div>

<div class="card">
    <h2 style="text-align: center; margin-bottom: 2rem;">System Features</h2>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; margin-top: 1rem;">
        <div style="padding: 1.5rem; background: linear-gradient(135deg, #667eea22 0%, #764ba233 100%); border-left: 5px solid #667eea; border-radius: 12px; transition: transform 0.3s, box-shadow 0.3s; cursor: default;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(102,126,234,0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
            <div style="font-size: 2.5rem; margin-bottom: 0.8rem;">üìö</div>
            <h3 style="color: #667eea; font-size: 1.2rem; margin-bottom: 0.8rem; font-weight: 600;">‚úì Official Legislation</h3>
            <p style="color: #555; line-height: 1.6; margin: 0;">All 2,234 ordinances from official HK e-Legislation XML database</p>
        </div>
        <div style="padding: 1.5rem; background: linear-gradient(135deg, #f093fb22 0%, #f5576c33 100%); border-left: 5px solid #e91e63; border-radius: 12px; transition: transform 0.3s, box-shadow 0.3s; cursor: default;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(233,30,99,0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
            <div style="font-size: 2.5rem; margin-bottom: 0.8rem;">üß†</div>
            <h3 style="color: #e91e63; font-size: 1.2rem; margin-bottom: 0.8rem; font-weight: 600;">‚úì Rule-Based Reasoning</h3>
            <p style="color: #555; line-height: 1.6; margin: 0;">Forward chaining inference engine with legal rule application</p>
        </div>
        <div style="padding: 1.5rem; background: linear-gradient(135deg, #4facfe22 0%, #00f2fe33 100%); border-left: 5px solid #4facfe; border-radius: 12px; transition: transform 0.3s, box-shadow 0.3s; cursor: default;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(79,172,254,0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
            <div style="font-size: 2.5rem; margin-bottom: 0.8rem;">üîç</div>
            <h3 style="color: #4facfe; font-size: 1.2rem; margin-bottom: 0.8rem; font-weight: 600;">‚úì Case Matching</h3>
            <p style="color: #555; line-height: 1.6; margin: 0;">TF-IDF vectorization with cosine similarity for finding precedents</p>
        </div>
        <div style="padding: 1.5rem; background: linear-gradient(135deg, #43e97b22 0%, #38f9d733 100%); border-left: 5px solid #1abc9c; border-radius: 12px; transition: transform 0.3s, box-shadow 0.3s; cursor: default;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(26,188,156,0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
            <div style="font-size: 2.5rem; margin-bottom: 0.8rem;">üìÑ</div>
            <h3 style="color: #1abc9c; font-size: 1.2rem; margin-bottom: 0.8rem; font-weight: 600;">‚úì Document Analysis</h3>
            <p style="color: #555; line-height: 1.6; margin: 0;">NLP-based automatic fact extraction and legal issue identification</p>
        </div>
        <div style="padding: 1.5rem; background: linear-gradient(135deg, #fa709a22 0%, #fee14033 100%); border-left: 5px solid #f39c12; border-radius: 12px; transition: transform 0.3s, box-shadow 0.3s; cursor: default;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(243,156,18,0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
            <div style="font-size: 2.5rem; margin-bottom: 0.8rem;">üí°</div>
            <h3 style="color: #f39c12; font-size: 1.2rem; margin-bottom: 0.8rem; font-weight: 600;">‚úì Explanation Facility</h3>
            <p style="color: #555; line-height: 1.6; margin: 0;">Clear reasoning chains with complete ordinance citations</p>
        </div>
        <div style="padding: 1.5rem; background: linear-gradient(135deg, #a18cd122 0%, #fbc2eb33 100%); border-left: 5px solid #9b59b6; border-radius: 12px; transition: transform 0.3s, box-shadow 0.3s; cursor: default;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 8px 20px rgba(155,89,182,0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
            <div style="font-size: 2.5rem; margin-bottom: 0.8rem;">üìÇ</div>
            <h3 style="color: #9b59b6; font-size: 1.2rem; margin-bottom: 0.8rem; font-weight: 600;">‚úì 11 Legal Categories</h3>
            <p style="color: #555; line-height: 1.6; margin: 0;">Criminal, civil, commercial, employment, property, family, and more</p>
        </div>
    </div>
</div>

<div class="card">
    <h2>üìö Legal Coverage - ALL Hong Kong Law</h2>
    <div id="categories-display" style="margin-top: 1rem;">
        <p style="text-align: center; color: #999;">Loading categories...</p>
    </div>
</div>

<div class="card">
    <h2 style="text-align: center; margin-bottom: 2rem;">üéØ Key Statistics</h2>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 2rem; margin-top: 1rem; text-align: center;">
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 2.5rem 2rem; border-radius: 12px; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3); transition: transform 0.3s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
            <div style="font-size: 3rem; font-weight: bold; margin-bottom: 0.5rem;" id="stat-ordinances">2,234</div>
            <div style="font-size: 1.1rem; opacity: 0.95;">Total Ordinances</div>
            <div style="font-size: 0.85rem; opacity: 0.8; margin-top: 0.5rem;">Official HK Law</div>
        </div>
        <div style="background: linear-gradient(135deg, #764ba2 0%, #f093fb 100%); color: white; padding: 2.5rem 2rem; border-radius: 12px; box-shadow: 0 4px 15px rgba(118, 75, 162, 0.3); transition: transform 0.3s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
            <div style="font-size: 3rem; font-weight: bold; margin-bottom: 0.5rem;" id="stat-sections">52,269</div>
            <div style="font-size: 1.1rem; opacity: 0.95;">Total Sections</div>
            <div style="font-size: 0.85rem; opacity: 0.8; margin-top: 0.5rem;">Legal Provisions</div>
        </div>
        <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 2.5rem 2rem; border-radius: 12px; box-shadow: 0 4px 15px rgba(240, 147, 251, 0.3); transition: transform 0.3s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
            <div style="font-size: 3rem; font-weight: bold; margin-bottom: 0.5rem;" id="stat-categories">11</div>
            <div style="font-size: 1.1rem; opacity: 0.95;">Legal Categories</div>
            <div style="font-size: 0.85rem; opacity: 0.8; margin-top: 0.5rem;">Comprehensive Coverage</div>
        </div>
    </div>
</div>

<script>
// Load statistics
fetch('/api/stats')
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            document.getElementById('total-sections').textContent = data.stats.total_sections.toLocaleString();
            document.getElementById('total-ordinances').textContent = data.stats.total_ordinances.toLocaleString();
            document.getElementById('stat-ordinances').textContent = data.stats.total_ordinances.toLocaleString();
            document.getElementById('stat-sections').textContent = data.stats.total_sections.toLocaleString();
            
            // Display categories
            const categoriesDiv = document.getElementById('categories-display');
            let html = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem;">';
            
            const sortedCategories = Object.entries(data.stats.categories).sort((a, b) => b[1].sections - a[1].sections);
            
            // Show ALL categories (no truncation)
            sortedCategories.forEach(([category, info]) => {
                const color = getCategoryColor(category);
                html += `
                    <a href="/category/${encodeURIComponent(category)}" style="text-decoration: none; display: block;">
                        <div style="padding: 1.2rem; background: linear-gradient(135deg, ${color}22 0%, ${color}11 100%); border-left: 4px solid ${color}; border-radius: 8px; transition: transform 0.2s, box-shadow 0.2s; cursor: pointer;" onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 6px 16px rgba(0,0,0,0.15)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                            <h4 style="color: ${color}; margin-bottom: 0.6rem; font-size: 1.05rem; font-weight: 600;">${category} ‚Üí</h4>
                            <p style="margin: 0; font-size: 0.9rem; color: #666; line-height: 1.5;">
                                <strong>${info.count}</strong> ordinances<br>
                                <strong>${info.sections.toLocaleString()}</strong> sections
                            </p>
                        </div>
                    </a>
                `;
            });
            
            html += '</div>';
            categoriesDiv.innerHTML = html;
            
            document.getElementById('total-categories').textContent = sortedCategories.length;
            document.getElementById('stat-categories').textContent = sortedCategories.length;
        }
    })
    .catch(error => console.error('Error loading stats:', error));

function getCategoryColor(category) {
    const colors = {
        'Criminal Law': '#e74c3c',
        'Civil Law': '#3498db',
        'Commercial & Company': '#9b59b6',
        'Employment Law': '#1abc9c',
        'Property & Land': '#f39c12',
        'Family Law': '#e91e63',
        'Tax & Revenue': '#34495e',
        'Immigration': '#16a085',
        'Intellectual Property': '#8e44ad',
        'Constitutional & Administrative': '#2c3e50',
        'Other': '#95a5a6'
    };
    return colors[category] || '#667eea';
}
</script>
{% endblock %}
